<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>RAT –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç</title>
    <script src="https://unpkg.com/jspsych@7.3.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-text@1.1.2"></script>
    <link href="https://unpkg.com/jspsych@7.3.3/css/jspsych.css" rel="stylesheet" />
    <style>
        body { 
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }
        .rat-container { 
            font-size: 22px; 
            max-width: 900px; 
            margin: 50px auto;
            text-align: center;
            line-height: 1.8;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .rat-words { 
            font-weight: bold; 
            color: #2c3e50; 
            margin: 30px 0; 
            font-size: 36px;
            letter-spacing: 2px;
        }
        .explanation-box {
            background: #ecf0f1;
            padding: 25px;
            border-radius: 8px;
            margin: 20px auto;
            max-width: 700px;
            text-align: left;
            font-size: 19px;
            line-height: 1.7;
        }
        .correct-answer {
            color: #27ae60;
            font-weight: bold;
            font-size: 28px;
        }
        .example-list {
            list-style: none;
            padding-left: 0;
            margin-top: 15px;
        }
        .example-list li {
            padding: 8px 0;
            font-size: 20px;
        }
        .checkmark {
            color: #27ae60;
            margin-right: 10px;
        }
        #skip-btn {
            display: none;
            margin-top: 30px;
            padding: 12px 25px;
            font-size: 16px;
            background-color: #95a5a6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #skip-btn:hover {
            background-color: #7f8c8d;
        }
    </style>
</head>
<body></body>
<script>

const CONDITION = 'control2';
const PARTICIPANT_ID = 'P' + Date.now();

const jsPsych = initJsPsych({
    on_finish: function() {
        jsPsych.getDisplayElement().innerHTML = `
            <div class="rat-container">
                <h2>–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∑–∞–≤–µ—Ä—à—ë–Ω!</h2>
                <br>
                <h3>–ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ!</h3>
                <br><br>
                <button onclick="downloadData()" style="font-size: 18px; padding: 15px 30px; cursor: pointer; background: #3498db; color: white; border: none; border-radius: 5px;">
                    üì• –°–∫–∞—á–∞—Ç—å –º–æ–∏ –¥–∞–Ω–Ω—ã–µ
                </button>
                <p style="color: #e74c3c; font-weight: bold; margin-top: 20px;">
                    –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
                </p>
            </div>
        `;
    }
});

function downloadData() {
    jsPsych.data.get().localSave('csv', `data_${CONDITION}_${PARTICIPANT_ID}.csv`);
}

const RAT_TASKS = [
    {words: ['–ü–ê–î–ê–¢–¨', '–õ–ê–ó–ò–¢–¨', '–ü–†–û–í–û–î–ò–¢–¨'], answer: '–í–û–î–ê'},
    {words: ['–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨', '–í–û–ó–ò–¢–¨', '–£–í–õ–ê–ñ–ù–Ø–¢–¨'], answer: '–ü–ê–†'},
    {words: ['–•–†–ê–ù–ò–¢–¨', '–õ–Æ–ë–ò–¢–¨', '–ò–ó–î–ê–í–ê–¢–¨'], answer: '–ö–ù–ò–ì–ê'},
    {words: ['–†–£–ë–ò–¢–¨', '–í–û–ó–ò–¢–¨', '–ü–ò–õ–ò–¢–¨'], answer: '–õ–ï–°'},
    {words: ['–ú–ï–¢–ê–¢–¨', '–¢–£–®–ò–¢–¨', '–°–¢–û–Ø–¢–¨'], answer: '–û–ì–û–ù–¨'},
    {words: ['–õ–ï–¢–ê–¢–¨', '–ü–ê–î–ê–¢–¨', '–°–ß–ò–¢–ê–¢–¨'], answer: '–ó–í–ï–ó–î–ê'},
    {words: ['–ü–ï–ß–¨', '–°–¢–û–Ø–¢–¨', '–õ–ï–ß–ò–¢–¨'], answer: '–°–û–õ–ù–¶–ï'},
    {words: ['–°–ö–õ–ê–î–´–í–ê–¢–¨', '–°–û–ß–ï–¢–ê–¢–¨', '–£–ü–û–¢–†–ï–ë–õ–Ø–¢–¨'], answer: '–°–õ–û–í–û'},
    {words: ['–ó–ê–ü–ò–°–´–í–ê–¢–¨', '–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–¢–¨', '–ù–ê–ë–õ–Æ–î–ê–¢–¨'], answer: '–í–ò–î–ï–û'},
    {words: ['–†–ï–ó–ê–¢–¨', '–õ–û–ú–ê–¢–¨', '–ö–†–£–ñ–ò–¢–¨'], answer: '–ì–û–õ–û–í–ê'},
    {words: ['–†–ï–ñ–ò–°–°–ò–†–û–í–ê–¢–¨', '–ò–ó–û–õ–ò–†–û–í–ê–¢–¨', '–£–°–ò–õ–ò–í–ê–¢–¨'], answer: '–ó–í–£–ö'},
    {words: ['–ü–ò–°–ê–¢–¨', '–ü–û–ñ–ò–ú–ê–¢–¨', '–ú–´–¢–¨'], answer: '–†–£–ö–ê'},
    {words: ['–°–ò–î–ï–¢–¨', '–°–¢–†–û–ò–¢–¨', '–£–ü–†–ê–í–õ–Ø–¢–¨'], answer: '–î–û–ú'},
    {words: ['–¢–†–Ø–°–¢–ò', '–†–´–¢–¨', '–î–ï–õ–ê–¢–¨'], answer: '–ó–ï–ú–õ–Ø'},
    {words: ['–•–†–ê–ù–ò–¢–¨', '–ì–†–ï–¢–¨', '–î–í–ò–ì–ê–¢–¨'], answer: '–¢–ï–õ–û'},
    {words: ['–ü–ò–¢–¨', '–í–ê–†–ò–¢–¨', '–ú–û–õ–û–¢–¨'], answer: '–ö–û–§–ï'},
    {words: ['–ü–ê–î–ê–¢–¨', '–¢–ï–°–ê–¢–¨', '–î–†–û–ë–ò–¢–¨'], answer: '–ö–ê–ú–ï–ù–¨'},
    {words: ['–•–£–õ–ò–¢–¨', '–Ø–í–õ–Ø–¢–¨–°–Ø', '–°–õ–£–ñ–ò–¢–¨'], answer: '–ë–û–ì'},
    {words: ['–ö–û–õ–û–¢–¨', '–†–ï–ó–ê–¢–¨', '–•–û–î–ò–¢–¨'], answer: '–õ–Å–î'},
    {words: ['–¢–ï–ß–¨', '–•–ê–†–ö–ê–¢–¨', '–ò–ó–õ–ò–í–ê–¢–¨'], answer: '–ö–†–û–í–¨'}
];

let timeline = [];
let task_start_time = null;
let current_task_skipped = false;

// –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
        <div class="rat-container">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç!</h2>
            <p>–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∑–∞–π–º—ë—Ç <strong>–Ω–µ –±–æ–ª–µ–µ 30 –º–∏–Ω—É—Ç</strong>.</p>
            <br>
            <p><strong>–í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:</strong></p>
            <ul style="text-align: left; max-width: 650px; margin: 20px auto; font-size: 19px; line-height: 1.6;">
                <li>–ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –Ω–µ –æ—Ç–≤–ª–µ–∫–∞—Ç—å—Å—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á</li>
                <li>–ï—Å–ª–∏ –ø–æ—á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –ø–ª–æ—Ö–æ ‚Äî –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç</li>
                <li><strong>–ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å —Ä–µ—à–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á</strong></li>
                <li>–í–∞–º –±—É–¥–µ—Ç –¥–∞–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É, –æ–¥–Ω–∞–∫–æ <strong>–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –µ–π —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ</strong></li>
                <li><strong>–ù–µ –Ω–∞–∂–∏–º–∞–π—Ç–µ –Ω–∞ –ø—Ä–æ–±–µ–ª</strong>, –µ—Å–ª–∏ –Ω–µ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª–∏ "–û–∑–∞—Ä–µ–Ω–∏–µ" –∏–ª–∏ –µ—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã –≤ –æ—Ç–≤–µ—Ç–µ ‚Äî <strong>–ª—É—á—à–µ –ø–æ–¥—É–º–∞–π—Ç–µ –µ—â—ë –Ω–µ–º–Ω–æ–≥–æ</strong></li>
            </ul>
            <br><br>
            <p><em>–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è</em></p>
        </div>
    `,
    choices: [' ']
});

// –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ RAT
timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
        <div class="rat-container">
            <h3>–ß—Ç–æ —Ç–∞–∫–æ–µ –∑–∞–¥–∞—á–∏ RAT?</h3>
            <div class="explanation-box">
                <p><strong>RAT (Remote Associates Test)</strong> ‚Äî —ç—Ç–æ –∑–∞–¥–∞—á–∏ –Ω–∞ –ø–æ–∏—Å–∫ –æ—Ç–¥–∞–ª—ë–Ω–Ω—ã—Ö –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π.</p>
                <p>–í–∞–º –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã <strong>3 –≥–ª–∞–≥–æ–ª–∞</strong>. –í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –Ω–∞–π—Ç–∏ <strong>–æ–¥–Ω–æ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ</strong>, –∫–æ—Ç–æ—Ä–æ–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω–æ —Å–æ –≤—Å–µ–º–∏ —Ç—Ä–µ–º—è –≥–ª–∞–≥–æ–ª–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.</p>
                <br>
                <p><strong>–ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?</strong></p>
                <p>–ù–∞–π–¥–µ–Ω–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ –¥–æ–ª–∂–Ω–æ <strong>–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ—á–µ—Ç–∞—Ç—å—Å—è</strong> —Å –∫–∞–∂–¥—ã–º –∏–∑ —Ç—Ä—ë—Ö –≥–ª–∞–≥–æ–ª–æ–≤.</p>
                <p><strong>–°–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Ä–∫–∏:</strong> –º—ã—Å–ª–µ–Ω–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ —Å –∫–∞–∂–¥—ã–º –≥–ª–∞–≥–æ–ª–æ–º. –ï—Å–ª–∏ –≤—Å–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è –∑–≤—É—á–∞—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ ‚Äî –æ—Ç–≤–µ—Ç –≤–µ—Ä–Ω—ã–π!</p>
            </div>
            <br>
            <p><em>–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞</em></p>
        </div>
    `,
    choices: [' ']
});

// –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º
timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
        <div class="rat-container">
            <h3>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä</h3>
            <p>–î–∞–Ω—ã —Ç—Ä–∏ –≥–ª–∞–≥–æ–ª–∞:</p>
            <div class="rat-words">–û–¢–ö–†–´–í–ê–¢–¨ ¬∑ –ó–ê–•–õ–û–ü–´–í–ê–¢–¨ ¬∑ –ö–†–ê–°–ò–¢–¨</div>
            <br>
            <p style="font-size: 20px;">–ö–∞–∫–æ–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ —Å–≤—è–∑–∞–Ω–æ —Å–æ –≤—Å–µ–º–∏ —Ç—Ä–µ–º—è?</p>
            <br>
            <p><em>–ü–æ–¥—É–º–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ</em></p>
        </div>
    `,
    choices: [' ']
});

timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
        <div class="rat-container">
            <h3>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</h3>
            <p class="correct-answer">–î–í–ï–†–¨</p>
            <br>
            <div class="explanation-box">
                <p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞:</strong></p>
                <ul class="example-list">
                    <li><span class="checkmark">‚úì</span> <strong>–û–¢–ö–†–´–í–ê–¢–¨</strong> –¥–≤–µ—Ä—å ‚Äî –∑–≤—É—á–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
                    <li><span class="checkmark">‚úì</span> <strong>–ó–ê–•–õ–û–ü–´–í–ê–¢–¨</strong> –¥–≤–µ—Ä—å ‚Äî –∑–≤—É—á–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
                    <li><span class="checkmark">‚úì</span> <strong>–ö–†–ê–°–ò–¢–¨</strong> –¥–≤–µ—Ä—å ‚Äî –∑–≤—É—á–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
                </ul>
                <br>
                <p>–í—Å–µ —Ç—Ä–∏ —Å–æ—á–µ—Ç–∞–Ω–∏—è –ª–æ–≥–∏—á–Ω—ã –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã! –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –æ—Ç–≤–µ—Ç <strong>–î–í–ï–†–¨</strong> –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.</p>
                <p style="color: #7f8c8d; margin-top: 15px;"><em>–í—ã –Ω–µ –æ—à–∏–±—ë—Ç–µ—Å—å —Å –æ—Ç–≤–µ—Ç–æ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –∫–æ –≤—Å–µ–º —Ç—Ä—ë–º –≥–ª–∞–≥–æ–ª–∞–º.</em></p>
            </div>
            <br>
            <p><em>–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è</em></p>
        </div>
    `,
    choices: [' ']
});

// –ú–æ–º–µ–Ω—Ç –∏–Ω—Å–∞–π—Ç–∞
timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
        <div class="rat-container">
            <h3>–í–∞–∂–Ω–æ: –º–æ–º–µ–Ω—Ç –æ–∑–∞—Ä–µ–Ω–∏—è ("–≠–≤—Ä–∏–∫–∞!")</h3>
            <div class="explanation-box">
                <p>–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á —É –≤–∞—Å –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –≤–Ω–µ–∑–∞–ø–Ω–æ–µ <strong>–æ–∑–∞—Ä–µ–Ω–∏–µ</strong> ‚Äî –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç "–ø—Ä–∏—Ö–æ–¥–∏—Ç" —Å–∞–º —Å–æ–±–æ–π.</p>
                <p>–≠—Ç–æ –æ—â—É—â–µ–Ω–∏–µ —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç <strong>"–≠–≤—Ä–∏–∫–∞!"</strong> –∏–ª–∏ <strong>"–ê–≥–∞-–º–æ–º–µ–Ω—Ç"</strong>.</p>
                <br>
                <p style="color: #e74c3c; font-weight: bold; font-size: 21px;">
                    ‚ö° –ö–æ–≥–¥–∞ –ø–æ—á—É–≤—Å—Ç–≤—É–µ—Ç–µ —ç—Ç–æ –æ–∑–∞—Ä–µ–Ω–∏–µ ‚Äî –°–†–ê–ó–£ –Ω–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ
                </p>
                <p>–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞.</p>
                <br>
                <p><strong>–ù–µ –Ω–∞–∂–∏–º–∞–π—Ç–µ –ø—Ä–æ–±–µ–ª</strong>, –µ—Å–ª–∏:</p>
                <ul style="text-align: left;">
                    <li>–í—ã –Ω–µ —É–≤–µ—Ä–µ–Ω—ã –≤ –æ—Ç–≤–µ—Ç–µ</li>
                    <li>–ü—Ä–æ—Å—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</li>
                    <li>–ù–µ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –º–æ–º–µ–Ω—Ç–∞ –æ–∑–∞—Ä–µ–Ω–∏—è</li>
                </ul>
                <p style="margin-top: 10px;">–í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö <strong>–ª—É—á—à–µ –ø–æ–¥—É–º–∞–π—Ç–µ –µ—â—ë</strong>.</p>
            </div>
            <br>
            <p><em>–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è</em></p>
        </div>
    `,
    choices: [' ']
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–±–Ω—ã—Ö –∑–∞–¥–∞—á (–° –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º)
function createPracticeTrial(task, task_label, explanation) {
    let trials = [];
    
    trials.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <div class="rat-container">
                <h3>${task_label}</h3>
                <p>–ù–∞–π–¥–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ:</p>
                <div class="rat-words">${task.words.join('   ¬∑   ')}</div>
                <br>
                <p style="color: #7f8c8d; font-size: 18px;">
                    <em>‚ö° –ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –≤ –º–æ–º–µ–Ω—Ç –∏–Ω—Å–∞–π—Ç–∞</em>
                </p>
            </div>
        `,
        choices: [' '],
        on_start: function() {
            task_start_time = performance.now();
        },
        on_finish: function(data) {
            data.insight_time = performance.now() - task_start_time;
            data.is_practice = true;
        }
    });
    
    trials.push({
        type: jsPsychSurveyText,
        questions: [{
            prompt: `
                <div class="rat-container">
                    <p>–ì–ª–∞–≥–æ–ª—ã: <strong style="color: #2c3e50; font-size: 24px;">${task.words.join(' ¬∑ ')}</strong></p>
                    <p>–í–≤–µ–¥–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ:</p>
                </div>
            `,
            name: 'answer',
            required: true,
            placeholder: '–í–∞—à –æ—Ç–≤–µ—Ç'
        }],
        on_finish: function(data) {
            data.user_answer = data.response.answer.toUpperCase().trim();
            data.correct_answer = task.answer;
            data.is_practice = true;
        }
    });
    
    // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
    trials.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <div class="rat-container">
                <h3>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</h3>
                <p class="correct-answer">${task.answer}</p>
                <br>
                <div class="explanation-box">
                    ${explanation}
                </div>
                <br>
                <p><em>–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è</em></p>
            </div>
        `,
        choices: [' ']
    });
    
    return trials;
}

// –ü—Ä–æ–±–Ω–∞—è –∑–∞–¥–∞—á–∞ 1
timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
        <div class="rat-container">
            <h3>–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏!</h3>
            <p>–°–µ–π—á–∞—Å –≤—ã —Ä–µ—à–∏—Ç–µ –¥–≤–µ –ø—Ä–æ–±–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º</p>
            <br>
            <p><em>–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ</em></p>
        </div>
    `,
    choices: [' ']
});

timeline.push(...createPracticeTrial(
    {words: ['–°–ú–û–¢–†–ï–¢–¨', '–õ–ï–¢–ê–¢–¨', '–í–ò–î–ï–¢–¨'], answer: '–ù–ï–ë–û'},
    '–ü—Ä–æ–±–Ω–∞—è –∑–∞–¥–∞—á–∞ 1',
    `
        <p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞:</strong></p>
        <ul class="example-list">
            <li><span class="checkmark">‚úì</span> <strong>–°–ú–û–¢–†–ï–¢–¨</strong> –Ω–∞ –Ω–µ–±–æ ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
            <li><span class="checkmark">‚úì</span> <strong>–õ–ï–¢–ê–¢–¨</strong> –ø–æ –Ω–µ–±—É ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
            <li><span class="checkmark">‚úì</span> <strong>–í–ò–î–ï–¢–¨</strong> –Ω–µ–±–æ ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
        </ul>
        <br>
        <p>–í—Å–µ —Ç—Ä–∏ —Å–æ—á–µ—Ç–∞–Ω–∏—è –∑–≤—É—á–∞—Ç –ª–æ–≥–∏—á–Ω–æ. –û—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!</p>
    `
));

// –ü—Ä–æ–±–Ω–∞—è –∑–∞–¥–∞—á–∞ 2
timeline.push(...createPracticeTrial(
    {words: ['–ß–ò–¢–ê–¢–¨', '–ü–ò–°–ê–¢–¨', '–û–¢–ö–†–´–í–ê–¢–¨'], answer: '–ö–ù–ò–ì–ê'},
    '–ü—Ä–æ–±–Ω–∞—è –∑–∞–¥–∞—á–∞ 2',
    `
        <p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞:</strong></p>
        <ul class="example-list">
            <li><span class="checkmark">‚úì</span> <strong>–ß–ò–¢–ê–¢–¨</strong> –∫–Ω–∏–≥—É ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
            <li><span class="checkmark">‚úì</span> <strong>–ü–ò–°–ê–¢–¨</strong> –∫–Ω–∏–≥—É ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
            <li><span class="checkmark">‚úì</span> <strong>–û–¢–ö–†–´–í–ê–¢–¨</strong> –∫–Ω–∏–≥—É ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ</li>
        </ul>
        <br>
        <p>–í—Å–µ —Ç—Ä–∏ –≥–ª–∞–≥–æ–ª–∞ —Ö–æ—Ä–æ—à–æ —Å–æ—á–µ—Ç–∞—é—Ç—Å—è —Å–æ —Å–ª–æ–≤–æ–º –ö–ù–ò–ì–ê!</p>
    `
));

// –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Å–Ω–æ–≤–Ω—ã–º –∑–∞–¥–∞—á–∞–º
timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
        <div class="rat-container">
            <h3>‚úì –ü—Ä–æ–±–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã</h3>
            <br>
            <p>–¢–µ–ø–µ—Ä—å –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á RAT.</p>
            <p>–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ—Å–Ω–æ–≤–Ω—ã–º –∑–∞–¥–∞—á–∞–º.</p>
            <p>–í—Å–µ–≥–æ –±—É–¥–µ—Ç <strong>20 –∑–∞–¥–∞—á</strong>.</p>
            <br>
            <div class="explanation-box" style="text-align: center;">
                <p><strong>–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ:</strong></p>
                <p>–ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É" –ø–æ—è–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ 40 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ –∑–∞–¥–∞—á–∏.</p>
                <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—ë —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ!</p>
            </div>
            <br><br>
            <p><em>–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞</em></p>
        </div>
    `,
    choices: [' ']
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á (–ë–ï–ó –æ–±—ä—è—Å–Ω–µ–Ω–∏—è)
function createRATTrial(task, task_number) {
    let trials = [];
    
    trials.push({
        type: jsPsychHtmlKeyboardResponse,
        stimulus: function() {
            return `
                <div class="rat-container">
                    <p style="color: #95a5a6; font-size: 18px;">–ó–∞–¥–∞—á–∞ ${task_number} / 20</p>
                    <p>–ù–∞–π–¥–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –≥–ª–∞–≥–æ–ª–∞–º–∏:</p>
                    <div class="rat-words">${task.words.join('   ¬∑   ')}</div>
                    <br>
                    <p style="color: #7f8c8d; font-size: 18px;">
                        <em>‚ö° –ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –≤ –º–æ–º–µ–Ω—Ç –∏–Ω—Å–∞–π—Ç–∞</em>
                    </p>
                    <button id="skip-btn" onclick="skipTask()">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É</button>
                </div>
            `;
        },
        choices: [' '],
        on_load: function() {
            current_task_skipped = false;
            
            window.skipTask = function() {
                current_task_skipped = true;
                jsPsych.finishTrial();
            };
            
            setTimeout(function() {
                const btn = document.getElementById('skip-btn');
                if (btn) btn.style.display = 'inline-block';
            }, 40000);
        },
        on_start: function() {
            task_start_time = performance.now();
        },
        on_finish: function(data) {
            const rt = performance.now() - task_start_time;
            data.insight_time = rt;
            data.task_words = task.words.join(',');
            data.correct_answer = task.answer;
            data.is_practice = false;
            data.condition = CONDITION;
            data.participant_id = PARTICIPANT_ID;
            data.task_number = task_number;
            data.was_skipped = current_task_skipped;
            
            if (current_task_skipped) {
                data.user_answer = 'SKIPPED';
                data.correct = false;
                data.trial_type_marker = 'rat_task';
            }
        }
    });
    
    trials.push({
        timeline: [{
            type: jsPsychSurveyText,
            questions: [{
                prompt: `
                    <div class="rat-container">
                        <p>–ì–ª–∞–≥–æ–ª—ã: <strong style="color: #2c3e50; font-size: 24px;">${task.words.join(' ¬∑ ')}</strong></p>
                        <p>–í–≤–µ–¥–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ:</p>
                    </div>
                `,
                name: 'answer',
                required: true,
                placeholder: '–í–∞—à –æ—Ç–≤–µ—Ç'
            }],
            on_finish: function(data) {
                const user_answer = data.response.answer.toUpperCase().trim();
                data.correct = (user_answer === task.answer);
                data.user_answer = user_answer;
                data.task_words = task.words.join(',');
                data.correct_answer = task.answer;
                data.is_practice = false;
                data.condition = CONDITION;
                data.participant_id = PARTICIPANT_ID;
                data.task_number = task_number;
                data.trial_type_marker = 'rat_task';
                data.was_skipped = false;
            }
        }],
        conditional_function: function() {
            return !current_task_skipped;
        }
    });
    
    return trials;
}

// –û—Å–Ω–æ–≤–Ω—ã–µ 20 –∑–∞–¥–∞—á
for (let i = 0; i < RAT_TASKS.length; i++) {
    timeline.push(...createRATTrial(RAT_TASKS[i], i + 1));
}

jsPsych.run(timeline);

</script>
</html>

